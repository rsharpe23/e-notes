СОЗДАНИЕ ПРОЕКТА

Flutter - это кроссплатформенный UI-фреймворк, написанный на языке Dart.
Процесс установки приведен в официальной документации: https://docs.flutter.dev/install

Проекты на flutter бывают 2х типов: приложения и библиотеки. Но у них схожая структура папок.
Корневыми папками в основном являются платформенные папки. Они содержат код и настройки
специфичные для каждой платформы:

 .dart_tool/
 android/
 assets/
 ios/
 lib/
 linux/
 macos/
 test/
 web/
 windows/
 .metadata
 pubspec.yaml
 pubspec.lock
 analysis_options.yaml

Папка .dart_tool создается автоматически при выполнение операций, связанных с интсрументами 
и пакетами. В ней содержатся временные файлы, кеши, артефакты и др.

Папка assets хранит ресурсы проекта (изображения, шрифты, иконки и пр.)
Папка lib - основная папка проекта, в которой находятся Dart-файлы (UI, бизнес-логика).
Папка test содержит юнит-тесты и виджет-тесты.

Файл .metadata используется средой разработки для отслеживания параметров проекта. В нем
может находиться информация о версии фреймворка, файлы для миграции на другую версию и пр.

Файл pubspec.yaml определяет конфигурацию проекта, зависимости, настройки сборки и др.

Файл pubspec.lock содержит информацию о версиях каждой установленной зависимости. Этот файл
не рекомендуется хранить в репозитории при разработке библиотек, т.к. зависимости библиотек
всегда должны быть самыми актуальными, во избежание проблем с безопасносью. Но это
накладывает на разработчика доп. обязанность - постоянно поддерживать совместимость 
своих библиотек с новыми версиями зависимостей.

Файл analysis_options.yaml определяет конфигурацию линтера.

Подробнее https://education.yandex.ru/handbook/flutter/article/flutter-struktura-proekta

Библиотеки также делятся на 2 типа: пакеты и плагины. Пакеты содержат только код, написанный
на Dart, а плагины, помимо Dart-кода, имеют еще платформо-специфичный код (нативный). Это
может быть ф-ционал для работы с ОС, доступ к аппаратной части (камера, блютуз) и др.

Официальный репозиторий пакетов для Dart и Flutter - страница pub.dev

Для управления пакетами и зависимостями используется инструмент командной строки pub, 
который входит в состав Dart SDK.

Чтобы вручную добавить зависимость, нужно в поле dependencies, файла pubspec.yaml, 
указать название нужной библиотеки. Зависимости бывают 4х типов:

 1) Зависимость из pub.dev                 2) Локальная зависимость
 
  dependencies:                             dependencies:
    dependency_name: <version>                <dependency_name>:
                                                path: <local_or_absolute_path>
 
 3) Hosted-зависимость (т.е. не из pub.dev, а с другого сайта)

  dependencies:
    <dependency_name>:
      hosted: https://some-package-server.com
      version: <version>

 4) Зависимость из github                    

  dependencies:
    <dependency_name>:                           
      git: https://github.com/<repo_url>           
                                                     
    или так                                                 
                      
    <dependency_name>
      git:
        url: https://github.com/<repo_url>
        ref: some-branch  ## номер коммита или название ветки, чтобы не тянуть из master
        path: sub-folder  ## путь к библиотеке, если она не в корне проекта

Для указаний ограничений на версии зависимостей использ. следующие операторы:

 any - любая версия зависимости;
 x.y.z - конкретная версия (x - мажор, y - минор, z - патч);
 >x.y.z - максимально возможная версия, что выше x.y.z;
 >=x.y.z - максимально возможная версия, что выше или равная x.y.z;;
 <x.y.z - максимально возможная версия, что ниже x.y.z;
 <=x.y.z - максимально возможная версия, что ниже или равная x.y.z;

 ^x.y.z - максимально возможная версия, что выше или равная x.y.z 
  но только в предалах минорных версий;

Можно также указывать диапазон версий, например >=1.12.8<=3.0.0 означает, что нужно
установить версию от 1.12.8 до 3.0.0 включительно.
 
Зависимости из поля dev_dependencies не попадают в сборку. Они нужнты только на этапе
разработки. Там указывается в основном различный инструментарий (зависимости для
тестов, линтеры и пр.) 

Установить все зависимости: flutter pub get (как npm install) 

Создать новый проект: flutter create project_name
Проект под определенные платформы: flutter create --platforms=ios,android project_name
Создать пакет:  flutter create --template=package package_name
Создать плагин: flutter create --template=plugin plugin_name 

Если проект не собирается, может помочь команда: flutter clean (очищает папку .dart_tools)
После нее нужно снова переустановить все зависимости через: flutter pub get 

После установки зависимостей они кешируются в папке .pub_cache. Но иногда кеш может слетать. 
В этом случае помогает его очистка и переустановка:

 flutter pub cache clean
 flutter pub cache repair

Иногда бывают ошибки связанные с платформо-специфичными библиотеками. Например когда
некоторые из них не установлены. В этом случае помогает их очистка и переустановка.

 pod deintegrate && pod install  // для iOS
 gradlew clean                   // для Android 

Сгенерировать документацию на основе коммпентариев из кода: dart doc

--------------------

РАБОТА С РЕСУРСАМИ

Для работы с ресурсами нужно сначала зарегистрировать их в файле pubspec.yaml

 flutter:
    assets:
      - assets/folder_name/asset_name.svg  ## Добавится изображение svg

      - assets/folder_name/   ## Добавятся все ресурсы из папки assets/folder_name
      - my_folder/            ## Добавятся все ресурсы из папки my_folder

      - packages/package_name/assets/folder_name/asset_name.png 

После регистрации изображений, получить доступ к ним можно через класс AssetImage 
или метод (фабричный конструктор?) Image.asset()

 // Доступ к конкретной иконке (без учета pixel ratio)
 Image.asset('assets/icon/heart.png');  

 // Доступ к наиболее подходящей по размеру иконке (с учетом pixel ratio)
 AssetImage('icons/heart.png');  

 // Если иконка берется из импортируемого пакета, то указываем его в пар-ре package
 AssetImage('icons/heart.png', package: 'my_icons');

Flutter может загружать наиболее подходящее изображение для текущего соотношения пикселей
(pixel ratio). Соотношение пикселей - это отношение между физическим кол-во пикселей
устройства и логическим кол-вом пикселей приложения. Чем больше разрешение экрана устройства
тем больше физических пикселей помещается в одном логическом пикселе. Логический пиксель -
это абстрактная единица измерения, используемая для создания интерфейса приложения.

Если pixel ratio больше 1.0, то для каждого логического пикселя будет использоваться
несколько физических пикселей (например, при pixel ratio 2.0 - на один логический пиксель
будет использоваться 4 физических пикселя)

Чтобы ресурсы могли автоматически сопостовляться со значением pixel ratio, они должны быть
организованы следующим образом (при этом регистрировать нужно только основной ресурс 
или его родительский каталог):

 my_icon/
   my_icon.png     (mdpi)

   1.5x/
     my_icon.png   (hdpi)

   2.0x/
     my_icon.png   (xhdpi)

   3.0x/
     my_icon.png   (xxhdpi)

Если pixel ration 1.8, то будет выбран ресурс 2.0x/my_icon.png
А если pixel ration 2.7, то 3.0x/my_icon.png

Шрифты регистрируются следующим образом:

 flutter:
   fonts:
    - family: Raleway
      fonts:
        - asset: assets/fonts/Raleway-Regular.ttf
        - asset: assets/fonts/Raleway-Italic.ttf
          style: italic
    - family: RobotoMono
      fonts:
        - asset: assets/fonts/RobotoMono-Regular.ttf
        - asset: assets/fonts/RobotoMono-Bold.ttf
          weight: 700

Параметр family определяет семейство шрифтов. Один шрифт может ссылаться на несколько файлов
с разными weight и style. (как в примере выше, где для RobotoMono с weight 700 задается
файл RobotoMono-Bold.ttf, а для обычного RobotoMono - RobotoMono-Regular.ttf)

После регистрации, шрифты и их стили можно задавать через класс TextStyle.

Для работы с текстовыми ассетами (файлы .txt или .json) - используется класс AssetBundle.
С AssetBundle можно работать либо через объект rootBundle, либо через объект
DefaultAssetBundle.

 import 'package:flutter/services.dart' show rootBundle;
 await rootBundle.loadString('assets/config.json'); 

Иконка приложения задается нативным способом для каждой из платформ.
Для Android размещается в папке android/app/src/main/res/
Для iOS размещается в папке ios/Runner/Assets.xcassets/AppIcon.appiconset/

Launch Screen (стартовый экран, который видит пользователь до тех пор, пока Flutter 
не отрисует первый кадр приложения) также устанавливается нативным способом.
Для Androind задается через файл android/app/src/main/res/drawable/launch_background.xml
Для iOS нужно разместить картинки (с названиями LaunchImage.png, LaunchImage@2x.png и т.д.)
в папке ios/Runner/Assets.xcassets/LaunchImage.imageset

--------------------





